import{i as e}from"./index.045aba51.js";import{r as a}from"./index.7bfec6ce.js";import{d as l,k as s,f as o,x as t,r as d,o as r,g as u,h as i,u as n,w as m,l as p,j as c,t as f}from"./vendor.83ae7723.js";class v{static sendMailCode(a){return e({method:"POST",url:"/tide-system/sendMailCode",params:{mail:a}})}static register(a){return e({method:"POST",url:"/tide-system/register",data:a})}}const w={style:{width:"400px","text-align":"center",position:"absolute",height:"20px",top:"0",left:"0",right:"0",bottom:"0",margin:"15% auto"}},h=c("发送验证码"),g=c("重置"),V=c("注册"),y=l({setup(e){s((()=>{document.title="注册"}));let l=o({mail:"",username:"",password:"",code:""}),y=o("");const b=t({username:[{required:!0,message:"请设置用户名"}],password:[{required:!0,message:"请设置密码"}],password2:[{validator:(e,a,s)=>{""!=l.value.password&&""==y.value?s(new Error("请再输入一次密码")):y.value!=l.value.password?s(new Error("两次输入密码不一致")):s()}}],mail:[{required:!0,message:"请输入邮箱账号"}],code:[{required:!0,message:"请输入邮箱验证码"}]}),_=o(!1);function x(){_.value=!0,v.sendMailCode(l.value.mail).then((e=>{_.value=!1,0==e.status&&k(e.data)})).catch((()=>{_.value=!1}))}let C=o("");function k(e){e>0&&(C.value=e+"s",setTimeout((()=>{k(--e)}),1e3)),0==e&&(C.value="")}const U=o();let j=o(!1);async function q(){j.value=!0,await n(U).validate((e=>{e?v.register(l.value).then((e=>{1==e.status&&a.push("/login"),C.value="",j.value=!1})).catch((()=>{j.value=!1})):j.value=!1}))}function M(){y.value="",n(U).resetFields(),C.value=""}return(e,a)=>{const s=d("el-input"),o=d("el-form-item"),t=d("el-button"),v=d("el-form");return r(),u("div",w,[i(v,{ref_key:"ruleFormRef",ref:U,model:n(l),rules:n(b),"label-width":"20%"},{default:m((()=>[i(o,{label:"账号",prop:"username"},{default:m((()=>[i(s,{modelValue:n(l).username,"onUpdate:modelValue":a[0]||(a[0]=e=>n(l).username=e),placeholder:"请设置账号"},null,8,["modelValue"])])),_:1}),i(o,{label:"密码",prop:"password"},{default:m((()=>[i(s,{modelValue:n(l).password,"onUpdate:modelValue":a[1]||(a[1]=e=>n(l).password=e),placeholder:"请设置密码",type:"password","show-password":""},null,8,["modelValue"])])),_:1}),i(o,{label:"确认密码",prop:"password2"},{default:m((()=>[i(s,{modelValue:n(y),"onUpdate:modelValue":a[2]||(a[2]=e=>p(y)?y.value=e:y=e),placeholder:"请再输入一次密码",type:"password","show-password":""},null,8,["modelValue"])])),_:1}),i(o,{label:"邮箱",prop:"mail"},{default:m((()=>[i(s,{style:{width:"60%"},modelValue:n(l).mail,"onUpdate:modelValue":a[3]||(a[3]=e=>n(l).mail=e),placeholder:"请输入邮箱"},null,8,["modelValue"]),i(t,{style:{"margin-left":"2%"},size:"small",type:"primary",loading:_.value,onClick:x},{default:m((()=>[h])),_:1},8,["loading"])])),_:1}),i(o,{label:"验证码",prop:"code"},{default:m((()=>[i(s,{style:{width:"60%"},modelValue:n(l).code,"onUpdate:modelValue":a[4]||(a[4]=e=>n(l).code=e),placeholder:"请输入你收到的验证码"},null,8,["modelValue"]),c(f(n(C)),1)])),_:1}),i(t,{onClick:M},{default:m((()=>[g])),_:1}),i(t,{type:"primary",loading:n(j),onClick:q},{default:m((()=>[V])),_:1},8,["loading"])])),_:1},8,["model","rules"])])}}});export{y as default};
