import{i as e}from"./request.fb45f519.js";import{r as a}from"./index.b4497eef.js";import{d as l,f as s,k as o,r as t,o as r,g as d,h as u,u as i,w as m,l as n,j as p,t as c}from"./vendor.c8305d94.js";class f{static sendCode(a){return e({method:"POST",url:"/tide-system/sendMailCode",params:{mail:a}})}static register(a){return e({method:"POST",url:"/tide-system/register",data:a})}}const w={style:{width:"400px","text-align":"center",position:"absolute",height:"20px",top:"0",left:"0",right:"0",bottom:"0",margin:"15% auto"}},h=p("发送验证码"),v=p("重置"),g=p("注册"),V=l({setup(e){let l=s({mail:"",username:"",password:"",code:""}),V=s("");const y=o({username:[{required:!0,message:"请设置用户名"}],password:[{required:!0,message:"请设置密码"}],password2:[{validator:(e,a,s)=>{""!=l.value.password&&""==V.value?s(new Error("请再输入一次密码")):V.value!=l.value.password?s(new Error("两次输入密码不一致")):s()}}],mail:[{required:!0,message:"请输入邮箱账号"}],code:[{required:!0,message:"请输入邮箱验证码"}]});function b(){f.sendCode(l.value.mail).then((e=>{0==e.status&&C(e.data)}))}let _=s("");function C(e){e>0&&(_.value=e+"s",setTimeout((()=>{C(--e)}),1e3)),0==e&&(_.value="")}const k=s();let q=s(!1);async function x(){q.value=!0,await i(k).validate((e=>{e?f.register(l.value).then((e=>{1==e.status&&a.push("/login"),_.value="",q.value=!1})).catch((()=>{q.value=!1})):q.value=!1}))}function U(){V.value="",i(k).resetFields(),_.value=""}return(e,a)=>{const s=t("el-input"),o=t("el-form-item"),f=t("el-button"),C=t("el-form");return r(),d("div",w,[u(C,{ref_key:"ruleFormRef",ref:k,model:i(l),rules:i(y),"label-width":"20%"},{default:m((()=>[u(o,{label:"账号",prop:"username"},{default:m((()=>[u(s,{modelValue:i(l).username,"onUpdate:modelValue":a[0]||(a[0]=e=>i(l).username=e),placeholder:"请设置账号"},null,8,["modelValue"])])),_:1}),u(o,{label:"密码",prop:"password"},{default:m((()=>[u(s,{modelValue:i(l).password,"onUpdate:modelValue":a[1]||(a[1]=e=>i(l).password=e),placeholder:"请设置密码",type:"password","show-password":""},null,8,["modelValue"])])),_:1}),u(o,{label:"确认密码",prop:"password2"},{default:m((()=>[u(s,{modelValue:i(V),"onUpdate:modelValue":a[2]||(a[2]=e=>n(V)?V.value=e:V=e),placeholder:"请再输入一次密码",type:"password","show-password":""},null,8,["modelValue"])])),_:1}),u(o,{label:"邮箱",prop:"mail"},{default:m((()=>[u(s,{style:{width:"60%"},modelValue:i(l).mail,"onUpdate:modelValue":a[3]||(a[3]=e=>i(l).mail=e),placeholder:"请输入邮箱"},null,8,["modelValue"]),u(f,{style:{"margin-left":"2%"},size:"small",type:"primary",onClick:b},{default:m((()=>[h])),_:1})])),_:1}),u(o,{label:"验证码",prop:"code"},{default:m((()=>[u(s,{style:{width:"60%"},modelValue:i(l).code,"onUpdate:modelValue":a[4]||(a[4]=e=>i(l).code=e),placeholder:"请输入你收到的验证码"},null,8,["modelValue"]),p(c(i(_)),1)])),_:1}),u(f,{onClick:U},{default:m((()=>[v])),_:1}),u(f,{type:"primary",loading:i(q),onClick:x},{default:m((()=>[g])),_:1},8,["loading"])])),_:1},8,["model","rules"])])}}});export{V as default};
